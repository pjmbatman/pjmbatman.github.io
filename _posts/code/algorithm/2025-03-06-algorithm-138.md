---
title: "ğŸ§  Algorithm 138: í›„ë³´í‚¤"
date: 2025-03-06
categories: [Code, Algorithm]
tags: [Python, Programmers, Lv2]
---

# í›„ë³´í‚¤

ìƒì„± ì¼ì‹œ: 2025ë…„ 3ì›” 6ì¼ ì˜¤í›„ 10:22
ë‚œì´ë„: í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ lv.2
ìœ í˜•: ì¡°í•©, íŠœí”Œ
í‘¼ ì‹œê°„ (ë¶„): 15
í‘¼ íšŸìˆ˜: 4
ì°¸ê³  ë§í¬: https://school.programmers.co.kr/learn/courses/30/lessons/42890

### **ë¬¸ì œ ì„¤ëª…**

# **í›„ë³´í‚¤**

í”„ë Œì¦ˆëŒ€í•™êµ ì»´í“¨í„°ê³µí•™ê³¼ ì¡°êµì¸ ì œì´ì§€ëŠ” ë„¤ì˜¤ í•™ê³¼ì¥ë‹˜ì˜ ì§€ì‹œë¡œ, í•™ìƒë“¤ì˜ ì¸ì ì‚¬í•­ì„ ì •ë¦¬í•˜ëŠ” ì—…ë¬´ë¥¼ ë‹´ë‹¹í•˜ê²Œ ë˜ì—ˆë‹¤.

ê·¸ì˜ í•™ë¶€ ì‹œì ˆ í”„ë¡œê·¸ë˜ë° ê²½í—˜ì„ ë˜ì‚´ë ¤, ëª¨ë“  ì¸ì ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë„£ê¸°ë¡œ í•˜ì˜€ê³ , ì´ë¥¼ ìœ„í•´ ì •ë¦¬ë¥¼ í•˜ë˜ ì¤‘ì— í›„ë³´í‚¤(Candidate Key)ì— ëŒ€í•œ ê³ ë¯¼ì´ í•„ìš”í•˜ê²Œ ë˜ì—ˆë‹¤.

í›„ë³´í‚¤ì— ëŒ€í•œ ë‚´ìš©ì´ ì˜ ê¸°ì–µë‚˜ì§€ ì•Šë˜ ì œì´ì§€ëŠ”, ì •í™•í•œ ë‚´ìš©ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì„œì ì„ í™•ì¸í•˜ì—¬ ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì„ í™•ì¸í•˜ì˜€ë‹¤.

- ê´€ê³„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¦´ë ˆì´ì…˜(Relation)ì˜ íŠœí”Œ(Tuple)ì„ ìœ ì¼í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì†ì„±(Attribute) ë˜ëŠ” ì†ì„±ì˜ ì§‘í•© ì¤‘, ë‹¤ìŒ ë‘ ì„±ì§ˆì„ ë§Œì¡±í•˜ëŠ” ê²ƒì„ í›„ë³´ í‚¤(Candidate Key)ë¼ê³  í•œë‹¤.
    - ìœ ì¼ì„±(uniqueness) : ë¦´ë ˆì´ì…˜ì— ìˆëŠ” ëª¨ë“  íŠœí”Œì— ëŒ€í•´ ìœ ì¼í•˜ê²Œ ì‹ë³„ë˜ì–´ì•¼ í•œë‹¤.
    - ìµœì†Œì„±(minimality) : ìœ ì¼ì„±ì„ ê°€ì§„ í‚¤ë¥¼ êµ¬ì„±í•˜ëŠ” ì†ì„±(Attribute) ì¤‘ í•˜ë‚˜ë¼ë„ ì œì™¸í•˜ëŠ” ê²½ìš° ìœ ì¼ì„±ì´ ê¹¨ì§€ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, ë¦´ë ˆì´ì…˜ì˜ ëª¨ë“  íŠœí”Œì„ ìœ ì¼í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë° ê¼­ í•„ìš”í•œ ì†ì„±ë“¤ë¡œë§Œ êµ¬ì„±ë˜ì–´ì•¼ í•œë‹¤.

ì œì´ì§€ë¥¼ ìœ„í•´, ì•„ë˜ì™€ ê°™ì€ í•™ìƒë“¤ì˜ ì¸ì ì‚¬í•­ì´ ì£¼ì–´ì¡Œì„ ë•Œ, í›„ë³´ í‚¤ì˜ ìµœëŒ€ ê°œìˆ˜ë¥¼ êµ¬í•˜ë¼.

![](https://grepp-programmers.s3.amazonaws.com/files/production/f1a3a40ede/005eb91e-58e5-4109-9567-deb5e94462e3.jpg)

ìœ„ì˜ ì˜ˆë¥¼ ì„¤ëª…í•˜ë©´, í•™ìƒì˜ ì¸ì ì‚¬í•­ ë¦´ë ˆì´ì…˜ì—ì„œ ëª¨ë“  í•™ìƒì€ ê°ì ìœ ì¼í•œ "í•™ë²ˆ"ì„ ê°€ì§€ê³  ìˆë‹¤. ë”°ë¼ì„œ "í•™ë²ˆ"ì€ ë¦´ë ˆì´ì…˜ì˜ í›„ë³´ í‚¤ê°€ ë  ìˆ˜ ìˆë‹¤.

ê·¸ë‹¤ìŒ "ì´ë¦„"ì— ëŒ€í•´ì„œëŠ” ê°™ì€ ì´ë¦„("apeach")ì„ ì‚¬ìš©í•˜ëŠ” í•™ìƒì´ ìˆê¸° ë•Œë¬¸ì—, "ì´ë¦„"ì€ í›„ë³´ í‚¤ê°€ ë  ìˆ˜ ì—†ë‹¤. ê·¸ëŸ¬ë‚˜, ë§Œì•½ ["ì´ë¦„", "ì „ê³µ"]ì„ í•¨ê»˜ ì‚¬ìš©í•œë‹¤ë©´ ë¦´ë ˆì´ì…˜ì˜ ëª¨ë“  íŠœí”Œì„ ìœ ì¼í•˜ê²Œ ì‹ë³„ ê°€ëŠ¥í•˜ë¯€ë¡œ í›„ë³´ í‚¤ê°€ ë  ìˆ˜ ìˆê²Œ ëœë‹¤.

ë¬¼ë¡  ["ì´ë¦„", "ì „ê³µ", "í•™ë…„"]ì„ í•¨ê»˜ ì‚¬ìš©í•´ë„ ë¦´ë ˆì´ì…˜ì˜ ëª¨ë“  íŠœí”Œì„ ìœ ì¼í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆì§€ë§Œ, ìµœì†Œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— í›„ë³´ í‚¤ê°€ ë  ìˆ˜ ì—†ë‹¤.

ë”°ë¼ì„œ, ìœ„ì˜ í•™ìƒ ì¸ì ì‚¬í•­ì˜ í›„ë³´í‚¤ëŠ” "í•™ë²ˆ", ["ì´ë¦„", "ì „ê³µ"] ë‘ ê°œê°€ ëœë‹¤.

ë¦´ë ˆì´ì…˜ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´ ë°°ì—´ relationì´ ë§¤ê°œë³€ìˆ˜ë¡œ ì£¼ì–´ì§ˆ ë•Œ, ì´ ë¦´ë ˆì´ì…˜ì—ì„œ í›„ë³´ í‚¤ì˜ ê°œìˆ˜ë¥¼ return í•˜ë„ë¡ solution í•¨ìˆ˜ë¥¼ ì™„ì„±í•˜ë¼.

### ì œí•œì‚¬í•­

- relationì€ 2ì°¨ì› ë¬¸ìì—´ ë°°ì—´ì´ë‹¤.
- relationì˜ ì»¬ëŸ¼(column)ì˜ ê¸¸ì´ëŠ”Â `1`Â ì´ìƒÂ `8`Â ì´í•˜ì´ë©°, ê°ê°ì˜ ì»¬ëŸ¼ì€ ë¦´ë ˆì´ì…˜ì˜ ì†ì„±ì„ ë‚˜íƒ€ë‚¸ë‹¤.
- relationì˜ ë¡œìš°(row)ì˜ ê¸¸ì´ëŠ”Â `1`Â ì´ìƒÂ `20`Â ì´í•˜ì´ë©°, ê°ê°ì˜ ë¡œìš°ëŠ” ë¦´ë ˆì´ì…˜ì˜ íŠœí”Œì„ ë‚˜íƒ€ë‚¸ë‹¤.
- relationì˜ ëª¨ë“  ë¬¸ìì—´ì˜ ê¸¸ì´ëŠ”Â `1`Â ì´ìƒÂ `8`Â ì´í•˜ì´ë©°, ì•ŒíŒŒë²³ ì†Œë¬¸ìì™€ ìˆ«ìë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.
- relationì˜ ëª¨ë“  íŠœí”Œì€ ìœ ì¼í•˜ê²Œ ì‹ë³„ ê°€ëŠ¥í•˜ë‹¤.(ì¦‰, ì¤‘ë³µë˜ëŠ” íŠœí”Œì€ ì—†ë‹¤.)

### ì…ì¶œë ¥ ì˜ˆ

| relation | result |
| --- | --- |
| `[["100","ryan","music","2"],["200","apeach","math","2"],["300","tube","computer","3"],["400","con","computer","4"],["500","muzi","music","3"],["600","apeach","music","2"]]` | 2 |

---

### ë¬¸ì œ í’€ì´

```python
# í›„ë³´ í‚¤ ê°¯ìˆ˜ ì°¾ê¸°

# ì „ì²´ ê°€ëŠ¥í•œ ê²½ìš°ì˜ ì¡°í•© ì°¾ê¸°

# ê·¸ ì¡°í•© í•˜ë‚˜í•˜ë‚˜ ìˆœíšŒí•´ë³´ë©´ì„œ ê·¸ ì¡°í•©ì´ ìœ ì¼ì„±ê³¼ ìµœì†Œì„±ì„ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸

# ë§Œì¡±í•˜ë©´ ì¹´ìš´íŠ¸

from itertools import combinations

def solution(relation):
    
    row_n = len(relation)
    col_n = len(relation[0])
    
    # ëª¨ë“  ì¡°í•©
    combs = []
    # 1ê°œ,2ê°œ...ì¹¼ëŸ¼ê°¯ìˆ˜ ë§Œí¼ ì¡°í•©ì„ ë‹¤ ì°¾ìŒ
    for i in range(1, col_n+1): # ê³µì§‘í•© ì œì™¸
        combs.extend(combinations(range(col_n), i))
    
    candidate_keys = []
    # ì¡°í•© ìˆœíšŒ
    for comb in combs:
        # ëª¨ë“  row ì €ì¥
        rows = set()
        is_unique = True
        # í•´ë‹¹ ì¡°í•©ì˜ rowë“¤ ì •ì˜
        for row in relation:
            new_row = [] # (1,2,3)
            for index in comb:
                new_row.append(row[index])
            new_row = tuple(new_row) # íŠœí”Œë¡œ ë³€í™˜, ì§‘í•©ì€ íŠœí”Œë§Œ ë„£ì„ ìˆ˜ ìˆìŒ
            if new_row in rows: # ê°™ì€ íŠœí”Œì´ ì´ë¯¸ ìˆë‹¤ë©´, ìœ ì¼ì„± íƒˆë½
                is_unique = False
                break
            rows.add(new_row)
            
        # ìµœì†Œì„± ê²€ì‚¬
        if is_unique:
            is_minimal = True
            for key in candidate_keys: # comb = (1,2,3) ë„£ì„ë ¤ëŠ”ë° ì´ë¯¸ key=(1,2)ê°€ ìˆë‹¤ë©´ì„ í…ŒìŠ¤íŠ¸
                if set(key).issubset(set(comb)):
                    is_minimal = False
            if is_minimal:
                candidate_keys.append(comb)
                    
            
    return len(candidate_keys)
```

```python
# í›„ë³´í‚¤: ìœ ì¼ì„±, ìµœì†Œì„±
# ìœ ì¼ì„± = í•´ë‹¹ columnì˜ ê°’ì¤‘ ìœ ì¼í•œ ê°’
# ìµœì†Œì„± = columnì„ ë¬¶ì—ˆì„ ë•Œ ìµœì†Œ ë¶€ë¶„ì§‘í•©ì¼ ê²ƒ -> [í•™ë²ˆ, ì´ë¦„], [í•™ë²ˆ, ì´ë¦„, ì „ê³µ]ì´ ìˆë‹¤ë©´ [í•™ë²ˆ, ì´ë¦„]ì´ ìµœì†Œì„±

# col ì¡°í•© ë§ˆë‹¤ ìœ ì¼ì„±, ìµœì†Œì„± ì²´í¬
from itertools import combinations

def solution(relation):
    
    col_size = len(relation[0])
    row_size = len(relation)
    
    combs = []
    for i in range(1, col_size+1):
        combs.extend(combinations(range(col_size), i))
    
    candidates = []

    for comb in combs:
        duplicate = set()
        is_unique = True
        for row in relation:
            new_row = []
            for index in comb:
                new_row.append(row[index])
            if tuple(new_row) in duplicate:
                is_unique = False
                break
            else:
                duplicate.add(tuple(new_row))
        
        if is_unique:
            is_minimal = True
            for can in candidates:
                if can.issubset(set(comb)):
                    is_minimal = False
            if is_minimal:
                candidates.append(set(comb))
    
    return len(candidates)
            
    
    
```